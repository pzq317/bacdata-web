{"ast":null,"code":"import _classCallCheck from \"/Users/pzq317/Desktop/project-bacdata/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/pzq317/Desktop/project-bacdata/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/pzq317/Desktop/project-bacdata/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/pzq317/Desktop/project-bacdata/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/pzq317/Desktop/project-bacdata/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/pzq317/Desktop/project-bacdata/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/pzq317/Desktop/project-bacdata/src/Value.js\";\nimport React, { Component } from 'react';\nimport * as d3 from 'd3';\nimport json from './data/world.json';\nimport csv from './data/world_trade_value.csv';\n\nvar Value =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Value, _Component);\n\n  function Value(props) {\n    var _this;\n\n    _classCallCheck(this, Value);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Value).call(this, props));\n    _this.state = {\n      data: {}\n    };\n    _this.drawChart = _this.drawChart.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.upDate = _this.upDate.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.convert = _this.convert.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Value, [{\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps) {\n      if (this.props.trade !== nextProps.trade || this.props.year !== nextProps.year) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.drawChart();\n      window.addEventListener('resize', this.upDate);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.upDate();\n    }\n  }, {\n    key: \"drawChart\",\n    value: function drawChart() {\n      d3.csv(csv, function (d) {\n        return {\n          Country: d.Country,\n          Year: +d.Year,\n          Trade: d.Trade,\n          Value: +d.Value\n        };\n      }.bind(this)).then(function (data) {\n        var _this2 = this;\n\n        this.setState({\n          data: data\n        });\n        var filteredData = data.filter(function (d) {\n          return d.Trade == _this2.props.trade && d.Year == _this2.props.year;\n        });\n        /*var margin = { top: 20, left: 0, bottom: 0, right: 0 };\n        var width = 65 - margin.left - margin.right;\n        var height = 520 - margin.top - margin.bottom;*/\n\n        var margin = {\n          top: 50,\n          left: 0,\n          bottom: 0,\n          right: 0\n        },\n            width = +d3.select('#worldmap-info-container').style('width').slice(0, -2) * 0.4 - margin.left - margin.right,\n            height = +d3.select('#worldmap-info-container').style('height').slice(0, -2) - margin.top - margin.bottom;\n        var unit = height / 10.8;\n        var svg = d3.select(\"#value-container\").append(\"svg\").attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom).attr('id', 'value-svg').append('g').attr('id', 'value').attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n        svg.selectAll('text').data(filteredData.sort(function (a, b) {\n          return b.Value - a.Value;\n        }).slice(0, 10), function (d) {\n          return d.Country;\n        }).enter().append('text') //.attr('x',10)\n        //.attr('y',function(d,i){ return i*50 + 10})\n        .attr('x', unit * 1 / 4).attr('y', function (d, i) {\n          return i * unit - 10;\n        }).attr('id', 'value-text').attr(\"dy\", \"1em\") //.attr('fill','#e0e0e0')\n        .style(\"opacity\", \"0\").text(function (d) {\n          return '$ ' + this.convert(d.Value);\n        }.bind(this)).transition().delay(500).duration(500 / 2).style(\"opacity\", 1);\n      }.bind(this));\n    }\n  }, {\n    key: \"upDate\",\n    value: function upDate() {\n      var _this3 = this;\n\n      var animation = 500;\n      var margin = {\n        top: 50,\n        left: 0,\n        bottom: 0,\n        right: 0\n      },\n          width = +d3.select('#worldmap-info-container').style('width').slice(0, -2) * 0.4 - margin.left - margin.right,\n          height = +d3.select('#worldmap-info-container').style('height').slice(0, -2) - margin.top - margin.bottom;\n      var unit = height / 10.8;\n      var data = this.state.data;\n      d3.select('#value-svg').attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom);\n      var svg = d3.select('#value');\n      var trade = this.props.trade;\n      var filteredData = data.filter(function (d) {\n        return d.Trade == _this3.props.trade && d.Year == _this3.props.year;\n      });\n      var text = svg.selectAll('text').data(filteredData.sort(function (a, b) {\n        return b.Value - a.Value;\n      }).slice(0, 10), function (d) {\n        return d.Country;\n      });\n      var scaleData = data.filter(function (d) {\n        return d.Trade == trade && d.Year == _this3.props.year;\n      });\n      text.attr('x', unit * 1 / 4).attr('y', function (d, i) {\n        return i * unit - 10;\n      }).attr(\"dy\", \"1em\").attr('id', 'value-text') //.attr('fill','#e0e0e0')\n      .style(\"opacity\", \"0\").text(function (d) {\n        return '$ ' + this.convert(d.Value);\n      }.bind(this)).transition().delay(animation).duration(animation / 2).style(\"opacity\", 1);\n      text.enter().append('text').attr('x', unit * 1 / 4).attr('y', function (d, i) {\n        return i * unit - 10;\n      }).attr(\"dy\", \"1em\").attr('id', 'value-text') //.attr('fill','#e0e0e0')\n      .style(\"opacity\", \"0\").text(function (d) {\n        return '$ ' + this.convert(d.Value);\n      }.bind(this)).transition().delay(animation).duration(animation / 2).style(\"opacity\", 1);\n      text.exit().remove();\n    }\n  }, {\n    key: \"convert\",\n    value: function convert(labelValue) {\n      // Nine Zeroes for Billions\n      return Math.abs(Number(labelValue)) >= 1.0e+9 ? Math.round(Math.abs(Number(labelValue)) / 1.0e+9 * 10) / 10 + \"B\" // Six Zeroes for Millions \n      : Math.abs(Number(labelValue)) >= 1.0e+6 ? Math.round(Math.abs(Number(labelValue)) / 1.0e+6 * 10) / 10 + \"M\" // Three Zeroes for Thousands\n      : Math.abs(Number(labelValue)) >= 1.0e+3 ? Math.round(Math.abs(Number(labelValue)) / 1.0e+3 * 10) / 10 + \"K\" : Math.abs(Number(labelValue));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        id: \"value-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Value;\n}(Component);\n\nexport { Value as default };","map":{"version":3,"sources":["/Users/pzq317/Desktop/project-bacdata/src/Value.js"],"names":["React","Component","d3","json","csv","Value","props","state","data","drawChart","bind","upDate","convert","nextProps","trade","year","window","addEventListener","d","Country","Year","Trade","then","setState","filteredData","filter","margin","top","left","bottom","right","width","select","style","slice","height","unit","svg","append","attr","selectAll","sort","a","b","enter","i","text","transition","delay","duration","animation","scaleData","exit","remove","labelValue","Math","abs","Number","round"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport * as d3 from 'd3'\nimport json from './data/world.json'\nimport csv from './data/world_trade_value.csv'\n\nexport default class Value extends Component{\n\tconstructor(props){\n        super(props);\n        this.state={\n        \tdata:{}\n        }\n        this.drawChart = this.drawChart.bind(this);\n        this.upDate = this.upDate.bind(this);\n        this.convert = this.convert.bind(this);\n    }\n\n    shouldComponentUpdate(nextProps){\n        if(this.props.trade !== nextProps.trade || this.props.year !== nextProps.year){\n            return true;\n        }\n        else{\n            return false;\n        }\n    }\n    \n  \tcomponentDidMount() {\n    \tthis.drawChart();\n    \twindow.addEventListener('resize', this.upDate)\n  \t}\n  \tcomponentDidUpdate(){\n  \t\tthis.upDate();\n  \t}\n\n  \tdrawChart() {\n\n\t\td3.csv(csv,function(d){\n\t\t\treturn {\n\t\t\t\tCountry : d.Country,\n\t\t\t\tYear : +d.Year,\n\t\t\t\tTrade : d.Trade,\n\t\t\t\tValue : +d.Value\n\n\t\t\t}\n\t\t}.bind(this)).then(function(data){\n\t\t\tthis.setState({\n\t\t\t\tdata: data\n\t\t\t}) \n\n\t\t\tvar filteredData = data.filter(d=>d.Trade == this.props.trade && d.Year == this.props.year);\n\n\t\t\t/*var margin = { top: 20, left: 0, bottom: 0, right: 0 };\n\t\t\tvar width = 65 - margin.left - margin.right;\n\t\t\tvar height = 520 - margin.top - margin.bottom;*/\n\t\t\tvar margin = { top: 50, left: 0, bottom: 0, right: 0 },\n\t\t\t\twidth = +d3.select('#worldmap-info-container').style('width').slice(0, -2)*0.4 - margin.left - margin.right,\n\t        \theight = +d3.select('#worldmap-info-container').style('height').slice(0, -2) - margin.top - margin.bottom;\n\t    \t\n\t    \tvar unit = height/10.8\n\n\t\t\tvar svg = d3.select(\"#value-container\").append(\"svg\")\n\t\t\t    .attr(\"width\", width + margin.left + margin.right)\n\t\t\t    .attr(\"height\", height + margin.top + margin.bottom)\n\t\t\t    .attr('id','value-svg')\n\t\t\t    .append('g')\n\t  \t\t\t.attr('id','value')\n\t\t\t\t.attr('transform','translate(' +margin.left+ ','+margin.top+')')\n\n\t\t\tsvg.selectAll('text')\n\t\t\t\t.data(filteredData.sort((a,b)=>{ return b.Value-a.Value }).slice(0,10),function(d){ return d.Country })\n\t\t\t\t.enter()\n\t\t\t\t.append('text')\n\t\t\t\t//.attr('x',10)\n\t\t\t\t//.attr('y',function(d,i){ return i*50 + 10})\n\t\t\t\t.attr('x',unit*1/4)\n\t\t\t\t.attr('y',function(d,i){ return i*unit - 10})\n\t\t\t\t.attr('id','value-text')\n\t\t\t\t.attr(\"dy\", \"1em\")\n\t\t\t\t//.attr('fill','#e0e0e0')\n\t\t\t\t.style(\"opacity\",\"0\")\n\t\t\t\t.text(function(d){ return '$ '+ this.convert(d.Value)}.bind(this))\n\t\t\t\t.transition()\n\t\t\t\t.delay(500)\n\t\t\t\t.duration(500/2)\n\t\t\t\t.style(\"opacity\",1);\n\n\t\t}.bind(this))\n\t}\n\n\tupDate(){\n\t\tvar animation = 500\n\n\t\tvar margin = { top: 50, left: 0, bottom: 0, right: 0 },\n\t\t\twidth = +d3.select('#worldmap-info-container').style('width').slice(0, -2)*0.4 - margin.left - margin.right,\n        \theight = +d3.select('#worldmap-info-container').style('height').slice(0, -2) - margin.top - margin.bottom;\n    \t\n    \tvar unit = height/10.8\n\t\tvar data = this.state.data\n\n\t\td3.select('#value-svg')\n\t\t\t.attr(\"width\", width + margin.left + margin.right)\n\t\t\t.attr(\"height\", height + margin.top + margin.bottom)\n\t\tvar svg = d3.select('#value')\n\t\tvar trade = this.props.trade\n\n\t\tvar filteredData = data.filter(d=>d.Trade == this.props.trade && d.Year == this.props.year);\n\n\t\tvar text = svg.selectAll('text')\n        \t.data(filteredData.sort((a,b)=>{ return b.Value-a.Value }).slice(0,10),function(d){ return d.Country })\n\t\t\n\t\tvar scaleData = data.filter(d=>d.Trade == trade && d.Year == this.props.year)\n\n\t\t\n\t\ttext.attr('x',unit*1/4)\n\t\t\t.attr('y',function(d,i){ return i*unit - 10})\n\t\t\t.attr(\"dy\", \"1em\")\n\t\t\t.attr('id','value-text')\n\t\t\t//.attr('fill','#e0e0e0')\n\t\t\t.style(\"opacity\",\"0\")\n\t\t\t.text(function(d){ return '$ '+ this.convert(d.Value) }.bind(this))\n\t\t\t.transition()\n\t\t\t.delay(animation)\n\t\t\t.duration(animation/2)\n\t\t\t.style(\"opacity\",1);\n\n\t\ttext.enter()\n    \t\t.append('text')\n\t\t\t.attr('x',unit*1/4)\n\t\t\t.attr('y',function(d,i){ return i*unit - 10})\n\t\t\t.attr(\"dy\", \"1em\")\n\t\t\t.attr('id','value-text')\n\t\t\t//.attr('fill','#e0e0e0')\n\t\t\t.style(\"opacity\",\"0\")\n\t\t\t.text(function(d){ return '$ '+this.convert(d.Value) }.bind(this))\n\t\t\t.transition()\n\t\t\t.delay(animation)\n\t\t\t.duration(animation/2)\n\t\t\t.style(\"opacity\",1);\n\n\n\t\ttext.exit()\n\t\t\t.remove();\n\t\t\t\n\t\t\n    }\n    convert(labelValue) {\n\n\t    // Nine Zeroes for Billions\n\t    return Math.abs(Number(labelValue)) >= 1.0e+9\n\n\t    ? Math.round((Math.abs(Number(labelValue)) / 1.0e+9)*10)/10 + \"B\"\n\t    // Six Zeroes for Millions \n\t    : Math.abs(Number(labelValue)) >= 1.0e+6\n\n\t    ? Math.round((Math.abs(Number(labelValue)) / 1.0e+6)*10)/10 + \"M\"\n\t    // Three Zeroes for Thousands\n\t    : Math.abs(Number(labelValue)) >= 1.0e+3\n\n\t    ? Math.round((Math.abs(Number(labelValue)) / 1.0e+3)*10)/10 + \"K\"\n\n\t    : Math.abs(Number(labelValue));\n\n\t}\n\n\trender(){\n\t\treturn(\n\t\t\t<div id='value-container'></div>\n\t\t)\n\t}\n\n}"]},"metadata":{},"sourceType":"module"}