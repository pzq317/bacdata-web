{"ast":null,"code":"import _classCallCheck from \"/Users/pzq317/Desktop/bacdata-web/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/pzq317/Desktop/bacdata-web/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/pzq317/Desktop/bacdata-web/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/pzq317/Desktop/bacdata-web/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/pzq317/Desktop/bacdata-web/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/pzq317/Desktop/bacdata-web/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/pzq317/Desktop/bacdata-web/src/Ranking.js\";\nimport React, { Component } from 'react';\nimport * as d3 from 'd3';\nimport json from './data/world.json';\nimport csv from './data/world_trade_value.csv';\n\nvar WorldMap =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(WorldMap, _Component);\n\n  function WorldMap(props) {\n    var _this;\n\n    _classCallCheck(this, WorldMap);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(WorldMap).call(this, props));\n    _this.state = {\n      data: {}\n    };\n    _this.drawChart = _this.drawChart.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.upDate = _this.upDate.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(WorldMap, [{\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps) {\n      if (this.props.trade !== nextProps.trade || this.props.year !== nextProps.year) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.drawChart();\n      window.addEventListener('resize', this.upDate);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.upDate();\n    }\n  }, {\n    key: \"drawChart\",\n    value: function drawChart() {\n      d3.csv(csv, function (d) {\n        return {\n          Country: d.Country,\n          Year: +d.Year,\n          Trade: d.Trade,\n          Value: +d.Value\n        };\n      }.bind(this)).then(function (data) {\n        var _this2 = this;\n\n        this.setState({\n          data: data\n        }); // var margin = { top: 20, left: 0, bottom: 0, right: 0 };\n        // var width = 150 - margin.left - margin.right;\n        // var height = 520 - margin.top - margin.bottom;\n\n        var margin = {\n          top: 50,\n          left: 0,\n          bottom: 0,\n          right: 0\n        },\n            width = +d3.select('#worldmap-info-container').style('width').slice(0, -2) * 0.4 - margin.left - margin.right,\n            height = +d3.select('#worldmap-info-container').style('height').slice(0, -2) - margin.top - margin.bottom;\n        var scaleData = data.filter(function (d) {\n          return d.Trade == _this2.props.trade && d.Year == _this2.props.year;\n        });\n        var colorScale = d3.scaleSequential(d3.interpolateYlGnBu).domain([d3.min(scaleData, function (d) {\n          return d[Object.keys(d)[3]];\n        }), d3.max(scaleData, function (d) {\n          return d[Object.keys(d)[3]];\n        })]);\n        var svg = d3.select(\"#ranking\").append(\"svg\").attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom).attr('id', 'ranking-svg-svg').append('g').attr('id', 'ranking-svg').attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n        /*var svg = d3.select(\"#ranking\").append(\"div\")\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .append('g')\n        \t\t\t.attr('id','ranking-svg')\n        \t.attr('transform','translate(' +margin.left+ ',' +margin.top+ ')')*/\n\n        var filteredData = data.filter(function (d) {\n          return d.Trade == _this2.props.trade && d.Year == _this2.props.year;\n        });\n        /*svg.selectAll('rect')\n        \t.data(filteredData.sort((a,b)=>{ return b.Value-a.Value }).slice(0,9),function(d){ return d.Country })\n        \t.enter()\n        \t.append('rect')\n        \t.attr('x',0)\n        \t.attr('y',function(d,i){ return i*30 })\n        \t.attr('width',100)\n        \t.attr('height',30)\n        \t.attr('fill','blue')*/\n\n        /*svg.selectAll('#country')\n        \t.data(filteredData.sort((a,b)=>{ return b.Value-a.Value }).slice(0,12),function(d){ return d.Country })\n        \t.enter()\n        \t.append('div')\n        \t.attr('width',100)\n        \t.attr('height',40)\n        \t.attr('background','blue')*/\n\n        var unit = height / 10.8;\n        svg.selectAll('circle').data(filteredData.sort(function (a, b) {\n          return b.Value - a.Value;\n        }).slice(0, 10), function (d) {\n          return d.Country;\n        }).enter().append('circle').attr('cx', 15).attr('cy', function (d, i) {\n          return i * unit;\n        }).attr('r', unit / 2 < 10 ? unit / 2 : 10).attr('fill', function (d) {\n          return colorScale(d.Value);\n        });\n        svg.selectAll('text').data(filteredData.sort(function (a, b) {\n          return b.Value - a.Value;\n        }).slice(0, 10), function (d) {\n          return d.Country;\n        }).enter().append('text').attr('x', unit * 2 / 3).attr('y', function (d, i) {\n          return i * unit - 10;\n        }).attr(\"dy\", \"1em\").attr(\"id\", \"country-name\") //.attr('fill','#e0e0e0')\n        .text(function (d) {\n          return d.Country;\n        });\n        /*svg.selectAll('div')\n        \t.data(filteredData.sort((a,b)=>{ return b.Value-a.Value }).slice(0,12),function(d){ return d.Country })\n        \t.enter()\n        \t.append('div')\n        \t.style('position','absolute')\n        \t.style('top', function(d,i){ return i*40 + 20 })\n        \t.style('width', 100 + \"px\")\n        \t.style('height', 40 + \"px\")\n        \t.style('background-color', 'blue')*/\n      }.bind(this));\n    }\n  }, {\n    key: \"upDate\",\n    value: function upDate() {\n      var _this3 = this;\n\n      var margin = {\n        top: 50,\n        left: 0,\n        bottom: 0,\n        right: 0\n      },\n          width = +d3.select('#worldmap-info-container').style('width').slice(0, -2) * 0.4 - margin.left - margin.right,\n          height = +d3.select('#worldmap-info-container').style('height').slice(0, -2) - margin.top - margin.bottom;\n      var unit = height / 10.8;\n      var data = this.state.data;\n      d3.select('#ranking-svg-svg').attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom);\n      var svg = d3.select('#ranking-svg');\n      var trade = this.props.trade;\n      var filteredData = data.filter(function (d) {\n        return d.Trade == _this3.props.trade && d.Year == _this3.props.year;\n      });\n      var circle = svg.selectAll('circle').data(filteredData.sort(function (a, b) {\n        return b.Value - a.Value;\n      }).slice(0, 10), function (d) {\n        return d.Country;\n      });\n      var text = svg.selectAll('text').data(filteredData.sort(function (a, b) {\n        return b.Value - a.Value;\n      }).slice(0, 10), function (d) {\n        return d.Country;\n      });\n      var scaleData = data.filter(function (d) {\n        return d.Trade == trade && d.Year == _this3.props.year;\n      });\n\n      if (trade == 'Export') {\n        var colorScale = d3.scaleSequential(d3.interpolateYlGnBu).domain([d3.min(scaleData, function (d) {\n          return d[Object.keys(d)[3]];\n        }), d3.max(scaleData, function (d) {\n          return d[Object.keys(d)[3]];\n        })]);\n      } else {\n        var colorScale = d3.scaleSequential(d3.interpolateOrRd).domain([d3.min(scaleData, function (d) {\n          return d[Object.keys(d)[3]];\n        }), d3.max(scaleData, function (d) {\n          return d[Object.keys(d)[3]];\n        })]);\n      }\n\n      circle.transition().duration(500).attr('cx', 15).attr('cy', function (d, i) {\n        return i * unit;\n      }).attr('r', unit / 2 < 10 ? unit / 2 : 10).attr('fill', function (d) {\n        return colorScale(d.Value);\n      });\n      circle.enter().append('circle').transition().duration(500).attr('cx', 15).attr('cy', function (d, i) {\n        return i * unit;\n      }).attr('r', unit / 2 < 10 ? unit / 2 : 10).attr('fill', function (d) {\n        return colorScale(d.Value);\n      });\n      text.transition().duration(500).attr('x', unit * 2 / 3).attr('y', function (d, i) {\n        return i * unit - 10;\n      }).attr(\"dy\", \"1em\").attr(\"id\", \"country-name\") //.attr('fill','#e0e0e0')\n      .text(function (d) {\n        return d.Country;\n      });\n      text.enter().append('text').transition().duration(500).attr('x', unit * 2 / 3).attr('y', function (d, i) {\n        return i * unit - 10;\n      }).attr(\"dy\", \"1em\").attr(\"id\", \"country-name\") //.attr('fill','#e0e0e0')\n      .text(function (d) {\n        return d.Country;\n      });\n      /*attr('x',0)\n      .attr('y',function(d,i){ return i*30 })\n      .attr(\"dy\", \"1em\")\n      .attr(\"id\",\"country-name\")\n      .text(function(d){ return d.Country });*/\n\n      circle.exit().remove();\n      text.exit().remove();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        id: \"ranking\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return WorldMap;\n}(Component);\n\nexport { WorldMap as default };","map":{"version":3,"sources":["/Users/pzq317/Desktop/bacdata-web/src/Ranking.js"],"names":["React","Component","d3","json","csv","WorldMap","props","state","data","drawChart","bind","upDate","nextProps","trade","year","window","addEventListener","d","Country","Year","Trade","Value","then","setState","margin","top","left","bottom","right","width","select","style","slice","height","scaleData","filter","colorScale","scaleSequential","interpolateYlGnBu","domain","min","Object","keys","max","svg","append","attr","filteredData","unit","selectAll","sort","a","b","enter","i","text","circle","interpolateOrRd","transition","duration","exit","remove"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport * as d3 from 'd3'\nimport json from './data/world.json'\nimport csv from './data/world_trade_value.csv'\n\nexport default class WorldMap extends Component{\n\tconstructor(props){\n        super(props);\n        this.state={\n        \tdata:{}\n        }\n        this.drawChart = this.drawChart.bind(this);\n        this.upDate = this.upDate.bind(this);\n    }\n\n    shouldComponentUpdate(nextProps){\n        if(this.props.trade !== nextProps.trade || this.props.year !== nextProps.year){\n            return true;\n        }\n        else{\n            return false;\n        }\n    }\n\n\n  \tcomponentDidMount() {\n    \tthis.drawChart();\n    \twindow.addEventListener('resize', this.upDate)\n  \t}\n  \tcomponentDidUpdate(){\n  \t\tthis.upDate();\n  \t}\n\n  \tdrawChart() {\n\n\t\td3.csv(csv,function(d){\n\t\t\treturn {\n\t\t\t\tCountry : d.Country,\n\t\t\t\tYear : +d.Year,\n\t\t\t\tTrade : d.Trade,\n\t\t\t\tValue : +d.Value\n\n\t\t\t}\n\t\t}.bind(this)).then(function(data){\n\t\t\tthis.setState({\n\t\t\t\tdata: data\n\t\t\t}) \n\n\t\t\t// var margin = { top: 20, left: 0, bottom: 0, right: 0 };\n\t\t\t// var width = 150 - margin.left - margin.right;\n\t\t\t// var height = 520 - margin.top - margin.bottom;\n\t\t\tvar margin = { top: 50, left: 0, bottom: 0, right: 0 },\n\t\t\t\twidth = +d3.select('#worldmap-info-container').style('width').slice(0, -2)*0.4 - margin.left - margin.right,\n            \theight = +d3.select('#worldmap-info-container').style('height').slice(0, -2) - margin.top - margin.bottom;\n        \n\n\n\t\t\tvar scaleData = data.filter(d=>d.Trade == this.props.trade && d.Year == this.props.year);\n\n\t\t\tvar colorScale = d3.scaleSequential(d3.interpolateYlGnBu)\n            \t.domain([d3.min(scaleData,function(d){ return d[Object.keys(d)[3]]}), d3.max(scaleData,function(d){return d[Object.keys(d)[3]]})])\n\n\t  \t\tvar svg = d3.select(\"#ranking\").append(\"svg\")\n\t\t\t    .attr(\"width\", width + margin.left + margin.right)\n\t\t\t    .attr(\"height\", height + margin.top + margin.bottom)\n\t\t\t    .attr('id','ranking-svg-svg')\n\t\t\t    .append('g')\n\t  \t\t\t.attr('id','ranking-svg')\n\t\t\t\t.attr('transform','translate(' +margin.left+ ','+margin.top+')')\n\t\t\t/*var svg = d3.select(\"#ranking\").append(\"div\")\n\t\t\t    .attr(\"width\", width + margin.left + margin.right)\n\t\t\t    .attr(\"height\", height + margin.top + margin.bottom)\n\t\t\t    .append('g')\n\t  \t\t\t.attr('id','ranking-svg')\n\t\t\t\t.attr('transform','translate(' +margin.left+ ',' +margin.top+ ')')*/\n\n\t\t\tvar filteredData = data.filter(d=>d.Trade == this.props.trade && d.Year == this.props.year);\n\n\t\t\t/*svg.selectAll('rect')\n\t\t\t\t.data(filteredData.sort((a,b)=>{ return b.Value-a.Value }).slice(0,9),function(d){ return d.Country })\n\t\t\t\t.enter()\n\t\t\t\t.append('rect')\n\t\t\t\t.attr('x',0)\n\t\t\t\t.attr('y',function(d,i){ return i*30 })\n\t\t\t\t.attr('width',100)\n\t\t\t\t.attr('height',30)\n\t\t\t\t.attr('fill','blue')*/\n\n\t\t\t/*svg.selectAll('#country')\n\t\t\t\t.data(filteredData.sort((a,b)=>{ return b.Value-a.Value }).slice(0,12),function(d){ return d.Country })\n\t\t\t\t.enter()\n\t\t\t\t.append('div')\n\t\t\t\t.attr('width',100)\n\t\t\t\t.attr('height',40)\n\t\t\t\t.attr('background','blue')*/\n\t\t\tvar unit = height/10.8\n\t\t\tsvg.selectAll('circle')\n\t\t\t\t.data(filteredData.sort((a,b)=>{ return b.Value-a.Value }).slice(0,10),function(d){ return d.Country })\n\t\t\t\t.enter()\n\t\t\t\t.append('circle')\n\t\t\t\t.attr('cx',15)\n\t\t\t\t.attr('cy',function(d,i){ return i*unit })\n\t\t\t\t.attr('r',(unit/2)<10?(unit/2):10)\n\t\t\t\t.attr('fill',function(d){ return colorScale(d.Value)} )\n\n\t\t\tsvg.selectAll('text')\n\t\t\t\t.data(filteredData.sort((a,b)=>{ return b.Value-a.Value }).slice(0,10),function(d){ return d.Country })\n\t\t\t\t.enter()\n\t\t\t\t.append('text')\n\t\t\t\t.attr('x',unit*2/3)\n\t\t\t\t.attr('y',function(d,i){ return i*unit - 10})\n\t\t\t\t.attr(\"dy\", \"1em\")\n\t\t\t\t.attr(\"id\",\"country-name\")\n\t\t\t\t//.attr('fill','#e0e0e0')\n\t\t\t\t.text(function(d){ return d.Country });\n\t\t\t/*svg.selectAll('div')\n\t\t\t\t.data(filteredData.sort((a,b)=>{ return b.Value-a.Value }).slice(0,12),function(d){ return d.Country })\n\t\t\t\t.enter()\n\t\t\t\t.append('div')\n\t\t\t\t.style('position','absolute')\n\t\t\t\t.style('top', function(d,i){ return i*40 + 20 })\n\t\t\t\t.style('width', 100 + \"px\")\n\t\t\t\t.style('height', 40 + \"px\")\n\t\t\t\t.style('background-color', 'blue')*/\n\n\n\t\t\t\n\t\t}.bind(this))\n\t}\n\n\tupDate(){\n\t\tvar margin = { top: 50, left: 0, bottom: 0, right: 0 },\n\t\t\twidth = +d3.select('#worldmap-info-container').style('width').slice(0, -2)*0.4 - margin.left - margin.right,\n        \theight = +d3.select('#worldmap-info-container').style('height').slice(0, -2) - margin.top - margin.bottom;\n    \tvar unit = height/10.8\n\n\t\tvar data = this.state.data\n\n\t\td3.select('#ranking-svg-svg')\n\t\t\t.attr(\"width\", width + margin.left + margin.right)\n\t\t\t.attr(\"height\", height + margin.top + margin.bottom)\n\n\t\tvar svg = d3.select('#ranking-svg')\n\n\t\tvar trade = this.props.trade\n\n\t\tvar filteredData = data.filter(d=>d.Trade == this.props.trade && d.Year == this.props.year);\n\n\t\tvar circle = svg.selectAll('circle')\n        \t.data(filteredData.sort((a,b)=>{ return b.Value-a.Value }).slice(0,10),function(d){ return d.Country })\n\t\t\n\t\tvar text = svg.selectAll('text')\n        \t.data(filteredData.sort((a,b)=>{ return b.Value-a.Value }).slice(0,10),function(d){ return d.Country })\n\t\t\n\t\tvar scaleData = data.filter(d=>d.Trade == trade && d.Year == this.props.year)\n\n\t\tif(trade=='Export'){\n\t\t\tvar colorScale = d3.scaleSequential(d3.interpolateYlGnBu)\n\t        \t.domain([d3.min(scaleData,function(d){ return d[Object.keys(d)[3]]}), d3.max(scaleData,function(d){return d[Object.keys(d)[3]]})])\n        }\n        else{\n        \tvar colorScale = d3.scaleSequential(d3.interpolateOrRd)\n\t        \t.domain([d3.min(scaleData,function(d){ return d[Object.keys(d)[3]]}), d3.max(scaleData,function(d){return d[Object.keys(d)[3]]})])\n        }\n\n\t\tcircle.transition()\n\t\t\t.duration(500)\n\t\t\t.attr('cx',15)\n\t\t\t.attr('cy',function(d,i){ return i*unit })\n\t\t\t.attr('r',(unit/2)<10?(unit/2):10)\n\t\t\t.attr('fill',function(d){ return colorScale(d.Value)} )\n\n\t\tcircle.enter()\n    \t\t.append('circle')\n    \t\t.transition()\n\t\t\t.duration(500) \n\t\t\t.attr('cx',15)\n\t\t\t.attr('cy',function(d,i){ return i*unit })\n\t\t\t.attr('r',(unit/2)<10?(unit/2):10)\n\t\t\t.attr('fill',function(d){ return colorScale(d.Value)} )\n\n\t\ttext.transition()\n\t\t\t.duration(500)\n\t\t\t.attr('x',unit*2/3)\n\t\t\t.attr('y',function(d,i){ return i*unit - 10})\n\t\t\t.attr(\"dy\", \"1em\")\n\t\t\t.attr(\"id\",\"country-name\")\n\t\t\t//.attr('fill','#e0e0e0')\n\t\t\t.text(function(d){ return d.Country });\n\n\t\ttext.enter()\n    \t\t.append('text')\n    \t\t.transition()\n\t\t\t.duration(500) \n\t\t\t.attr('x',unit*2/3)\n\t\t\t.attr('y',function(d,i){ return i*unit - 10})\n\t\t\t.attr(\"dy\", \"1em\")\n\t\t\t.attr(\"id\",\"country-name\")\n\t\t\t//.attr('fill','#e0e0e0')\n\t\t\t.text(function(d){ return d.Country });\n\n\n\t\t\t/*attr('x',0)\n\t\t\t.attr('y',function(d,i){ return i*30 })\n\t\t\t.attr(\"dy\", \"1em\")\n\t\t\t.attr(\"id\",\"country-name\")\n\t\t\t.text(function(d){ return d.Country });*/\n\n\t\t\tcircle.exit()\n\t\t\t\t.remove();\n\n\t\t\ttext.exit()\n\t\t\t\t.remove();\n    }\n\n\trender(){\n\t\treturn(\n\t\t\t<div id='ranking'></div>\n\t\t)\n\t}\n\n}"]},"metadata":{},"sourceType":"module"}