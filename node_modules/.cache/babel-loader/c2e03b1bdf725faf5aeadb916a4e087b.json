{"ast":null,"code":"import _classCallCheck from \"/Users/pzq317/Desktop/bacdata-web/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/pzq317/Desktop/bacdata-web/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/pzq317/Desktop/bacdata-web/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/pzq317/Desktop/bacdata-web/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/pzq317/Desktop/bacdata-web/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/pzq317/Desktop/bacdata-web/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/pzq317/Desktop/bacdata-web/src/SparkLines.js\";\nimport React, { Component } from 'react';\nimport * as d3 from 'd3';\nimport json from './data/world.json';\nimport csv from './data/world_trade_value.csv';\n\nvar SparkLines =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(SparkLines, _Component);\n\n  function SparkLines(props) {\n    var _this;\n\n    _classCallCheck(this, SparkLines);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SparkLines).call(this, props));\n    _this.state = {\n      data: {}\n    };\n    _this.drawChart = _this.drawChart.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.drawSparkLine = _this.drawSparkLine.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.upDate = _this.upDate.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(SparkLines, [{\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps) {\n      if (this.props.trade !== nextProps.trade || this.props.year !== nextProps.year) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.drawChart();\n      window.addEventListener('resize', function () {\n        console.log('sparkline resize');\n        var data = _this2.state.data;\n        var filteredData = data.filter(function (d) {\n          return d.Trade == _this2.props.trade && d.Year == _this2.props.year;\n        }).sort(function (a, b) {\n          return b.Value - a.Value;\n        }).slice(0, 12);\n        filteredData.forEach(function (target, i) {\n          var temp = data.filter(function (d) {\n            return d.Country == target.Country && d.Trade == _this2.props.trade;\n          });\n\n          _this2.upDate(temp, i);\n        });\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      var _this3 = this;\n\n      var data = this.state.data;\n      var filteredData = data.filter(function (d) {\n        return d.Trade == _this3.props.trade && d.Year == _this3.props.year;\n      }).sort(function (a, b) {\n        return b.Value - a.Value;\n      }).slice(0, 12);\n      filteredData.forEach(function (target, i) {\n        var temp = data.filter(function (d) {\n          return d.Country == target.Country && d.Trade == _this3.props.trade;\n        });\n\n        _this3.upDate(temp, i);\n      });\n    }\n  }, {\n    key: \"drawChart\",\n    value: function drawChart() {\n      d3.csv(csv, function (d) {\n        return {\n          Country: d.Country,\n          Year: +d.Year,\n          Trade: d.Trade,\n          Value: +d.Value\n        };\n      }.bind(this)).then(function (data) {\n        var _this4 = this;\n\n        this.setState({\n          data: data\n        });\n        var filteredData = data.filter(function (d) {\n          return d.Trade == _this4.props.trade && d.Year == _this4.props.year;\n        }).sort(function (a, b) {\n          return b.Value - a.Value;\n        }).slice(0, 10);\n        var margin = {\n          top: 50,\n          left: 0,\n          bottom: 0,\n          right: 0\n        },\n            width = +d3.select('#worldmap-info-container').style('width').slice(0, -2) * 0.3 - margin.left - margin.right,\n            height = +d3.select('#worldmap-info-container').style('height').slice(0, -2) - margin.top - margin.bottom;\n        console.log('draw', height);\n        var unit = height / 10.8;\n        /*var div = d3.select(\"#sparklines-container\").append(\"div\")\n            .style(\"width\", width + margin.left + margin.right + 'px')\n            .style(\"height\", height + margin.top + margin.bottom + 'px')\n            .attr(\"id\",'sparklines')\n            \n        \n        div.selectAll('rect')\n        \t.data(filteredData,function(d){ return d.Country })\n        \t.enter()\n        \t.append('div')\n        \t.attr('id',function(d,i){ return 'div' + i })\n        \t.style(\"height\", unit + 'px')\n        \t.style(\"height\", width + 'px')\n        \t//.text(function(d){ return d.Country })\n        \tfilteredData.forEach((target,i)=>{\n        \tvar temp = data.filter(d=> d.Country == target.Country && d.Trade == this.props.trade)\n        \t//console.log(temp,target.Country)\n        \tthis.drawSparkLine(temp,i)\n        })*/\n\n        var svg = d3.select(\"#sparklines-container\").append(\"svg\").style(\"width\", width + margin.left + margin.right).style(\"height\", height + margin.top + margin.bottom).attr(\"id\", 'sparklines').append('g').attr('id', 'sparklines-svg').attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n        filteredData.forEach(function (target, i) {\n          var temp = data.filter(function (d) {\n            return d.Country == target.Country && d.Trade == _this4.props.trade;\n          }); //console.log(temp,target.Country)\n\n          _this4.drawSparkLine(temp, i);\n        });\n        /*var svg = d3.select(\"#sparklines-container\").append(\"svg\")\n            .style(\"width\", width + margin.left + margin.right + 'px')\n            .style(\"height\", height + margin.top + margin.bottom + 'px')\n            .append('g')\n        \t\t\t.attr('id','sparklines')\n        \t.attr('transform','translate(' +margin.left+ ',0)')*/\n\n        /*var x = d3.scaleOrdinal().domain([2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016]).range([0, 150]);\n        console.log(d3.extent(filteredData,function(d){ return d[Object.keys(d)[3]]}))\n        var y = d3.scaleLinear().domain(d3.extent(filteredData,function(d){ return d[Object.keys(d)[3]]})).range([0, 30]);*/\n\n        /*var svg = d3.select(\"#sparklines\").append(\"svg\")\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .append('g')\n        \t\t\t.attr('id','ranking-svg')\n        \t.attr('transform','translate(' +margin.left+ ',' +margin.top+ ')')*/\n      }.bind(this));\n    }\n  }, {\n    key: \"drawSparkLine\",\n    value: function drawSparkLine(data, i) {\n      var _this5 = this;\n\n      //console.log(data)\n      var margin = {\n        top: 50,\n        left: 0,\n        bottom: 0,\n        right: 0\n      },\n          width = +d3.select('#worldmap-info-container').style('width').slice(0, -2) * 0.3 - margin.left - margin.right,\n          height = +d3.select('#worldmap-info-container').style('height').slice(0, -2) - margin.top - margin.bottom;\n      console.log('draw spark line', height);\n      d3.select('#sparklines').style(\"width\", width + margin.left + margin.right).style(\"height\", height + margin.top + margin.bottom);\n      var unit = height / 10.8;\n      var xScale = d3.scalePoint().domain([2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016]).range([5, width - 5]);\n      var yScale = d3.scaleLinear().domain(d3.extent(data, function (d) {\n        return d.Value;\n      })).range([(i + 0.5) * unit - 5, (i - 0.5) * unit + 5]);\n      var svg = d3.select('#sparklines-svg');\n      var line = d3.line().x(function (d) {\n        return xScale(d.Year);\n      }).y(function (d) {\n        return yScale(d.Value);\n      }).curve(d3.curveMonotoneX);\n      var value = data.filter(function (d) {\n        return d.Year == _this5.props.year;\n      })[0].Value;\n      svg.append(\"path\").datum(data).attr(\"id\", \"sparkline-\" + i).attr(\"d\", line).attr(\"stroke\", \"black\").attr(\"stroke-width\", 0.5).attr(\"fill\", \"none\");\n      var div = d3.select('.tooltip');\n      svg.append('circle').attr('cx', xScale(this.props.year)).attr('cy', yScale(value)).attr('id', \"circle-\" + i).attr('r', 2).attr('fill', 'red').on(\"mouseover\", function (d) {\n        div.style(\"opacity\", .9).style('z-index', 10);\n        div.html(_this5.props.year); // data.filter(d=>d.Year == this.props.year)[0].Value\t\n      }).on(\"mousemove\", function () {\n        div.style(\"left\", d3.event.pageX + 10 + \"px\").style(\"top\", d3.event.pageY - 10 + \"px\");\n      }).on(\"mouseout\", function () {\n        div.style(\"opacity\", 0).style('z-index', -10);\n      });\n      /*var svg = d3.select('#div'+i)\n      \t.append('svg')\n      \t.attr('width',width)\n      \t.attr('height',unit)\n      \t.attr('id','svg' + i)\n      \tvar value = data.filter(d=>d.Year == this.props.year)[0].Value\n      \tvar xScale = d3.scalePoint().domain([2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016]).range([5, width-5]);\n      var yScale = d3.scaleLinear().domain(d3.extent(data,function(d){ return d.Value})).range([unit-5, 5]);\n      \t//console.log(d3.extent(data,function(d){ return d.Value}))\n      \n      var line = d3.line()\n          .x(function(d) { return xScale(d.Year); }) \n          .y(function(d) { return yScale(d.Value); })\n          .curve(d3.curveMonotoneX)\n      \td3.select('#sparklines').style(\"height\", height + 'px').style('width',width + 'px')\n      d3.select('#div'+i).style(\"height\", unit + 'px').style('width',width + 'px')\n      svg.append(\"path\")\n          .datum(data)\n          .attr(\"id\", \"sparkline-\"+i)\n          .attr(\"d\", line)\n          .attr(\"stroke\", \"black\")\n                .attr(\"stroke-width\", 0.5)\n                .attr(\"fill\", \"none\")\n       \n            var div = d3.select('.tooltip')\n            svg.append('circle')\n      \t.attr('cx',xScale(this.props.year))\n      \t.attr('cy',yScale(value))\n      \t.attr('r',2)\n      \t.attr('fill','red')\n      \t.on(\"mouseover\", (d) => {\n      \t\t\n      \t\tdiv.style(\"opacity\", .9)\n      \t\t\t.style('z-index',10)\n      \t\tdiv.html(this.props.year)\n      \t\t// data.filter(d=>d.Year == this.props.year)[0].Value\t\n      \t})\n      \t.on(\"mousemove\", function () {\n      \t\tdiv.style(\"left\", (d3.event.pageX + 10) + \"px\")\n      \t\t\t.style(\"top\", (d3.event.pageY - 10) + \"px\")\n      \t})\n      \t.on(\"mouseout\", function () {\n      \t\tdiv.style(\"opacity\", 0)\n      \t\t\t.style('z-index',-10)\n      \t});*/\n    }\n  }, {\n    key: \"upDate\",\n    value: function upDate(data, i) {\n      var _this6 = this;\n\n      var margin = {\n        top: 50,\n        left: 0,\n        bottom: 0,\n        right: 0\n      },\n          width = +d3.select('#worldmap-info-container').style('width').slice(0, -2) * 0.3 - margin.left - margin.right,\n          height = +d3.select('#worldmap-info-container').style('height').slice(0, -2) - margin.top - margin.bottom;\n      console.log(width, height);\n      var unit = height / 10.8; //console.log(data,i)\n\n      var value = data.filter(function (d) {\n        return d.Year == _this6.props.year;\n      })[0].Value;\n      var xScale = d3.scalePoint().domain([2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016]).range([5, width - 5]);\n      var yScale = d3.scaleLinear().domain(d3.extent(data, function (d) {\n        return d.Value;\n      })).range([(i + 0.5) * unit - 5, (i - 0.5) * unit + 5]); //console.log(d3.extent(data,function(d){ return d.Value}))\n\n      d3.select('#sparklines').style(\"width\", width + margin.left + margin.right).style(\"height\", height + margin.top + margin.bottom);\n      var line = d3.line().x(function (d) {\n        return xScale(d.Year);\n      }).y(function (d) {\n        return yScale(d.Value);\n      }).curve(d3.curveMonotoneX);\n      /*var svg = d3.select('#svg'+i)\n      \t\t\t.attr('width',width)\n      \t\t\t.attr('height',unit)\n      \td3.select('#sparklines').style(\"height\", height + 'px').style('width',width + 'px')\n      d3.select('#div'+i).style(\"height\", unit + 'px').style('width',width + 'px')*/\n\n      d3.select('#sparkline-' + i).datum(data) //.attr(\"id\", \"sparkline-\"+i)\n      .transition().duration(500).attr(\"d\", line).attr(\"stroke\", \"black\").attr(\"stroke-width\", 0.5).attr(\"fill\", \"none\");\n      d3.select('#circle-' + i).transition().duration(500).attr('cx', xScale(this.props.year)).attr('cy', yScale(value)).attr('r', 2).attr('fill', 'red');\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        id: \"sparklines-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 292\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return SparkLines;\n}(Component);\n\nexport { SparkLines as default };","map":{"version":3,"sources":["/Users/pzq317/Desktop/bacdata-web/src/SparkLines.js"],"names":["React","Component","d3","json","csv","SparkLines","props","state","data","drawChart","bind","drawSparkLine","upDate","nextProps","trade","year","window","addEventListener","console","log","filteredData","filter","d","Trade","Year","sort","a","b","Value","slice","forEach","target","i","temp","Country","then","setState","margin","top","left","bottom","right","width","select","style","height","unit","svg","append","attr","xScale","scalePoint","domain","range","yScale","scaleLinear","extent","line","x","y","curve","curveMonotoneX","value","datum","div","on","html","event","pageX","pageY","transition","duration"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport * as d3 from 'd3'\nimport json from './data/world.json'\nimport csv from './data/world_trade_value.csv'\n\nexport default class SparkLines extends Component{\n\tconstructor(props){\n        super(props);\n        this.state={\n        \tdata:{}\n        }\n        this.drawChart = this.drawChart.bind(this);\n        this.drawSparkLine = this.drawSparkLine.bind(this);\n        this.upDate = this.upDate.bind(this);\n    }\n\n\n    shouldComponentUpdate(nextProps){\n        if(this.props.trade !== nextProps.trade || this.props.year !== nextProps.year){\n            return true;\n        }\n        else{\n            return false;\n        }\n    }\n\n  \tcomponentDidMount() {\n    \tthis.drawChart();\n    \twindow.addEventListener('resize', ()=>{\n    \t\tconsole.log('sparkline resize')\n    \t\tvar data = this.state.data\n\t  \t\tvar filteredData = data.filter(d=>d.Trade == this.props.trade && d.Year == this.props.year).sort((a,b)=>{ return b.Value-a.Value }).slice(0,12);\n\t  \t\tfilteredData.forEach((target, i)=>{\n\t\t\t\tvar temp = data.filter(d=> d.Country == target.Country && d.Trade == this.props.trade)\n\t\t\t\tthis.upDate(temp,i);\n\t\t\t})\n    \t})\n  \t}\n  \tcomponentDidUpdate(){\n  \t\tvar data = this.state.data\n  \t\tvar filteredData = data.filter(d=>d.Trade == this.props.trade && d.Year == this.props.year).sort((a,b)=>{ return b.Value-a.Value }).slice(0,12);\n  \t\tfilteredData.forEach((target, i)=>{\n\t\t\tvar temp = data.filter(d=> d.Country == target.Country && d.Trade == this.props.trade)\n\t\t\tthis.upDate(temp,i);\n\t\t})\n  \t}\n\n  \tdrawChart() {\n\n\t\td3.csv(csv,function(d){\n\t\t\treturn {\n\t\t\t\tCountry : d.Country,\n\t\t\t\tYear : +d.Year,\n\t\t\t\tTrade : d.Trade,\n\t\t\t\tValue : +d.Value\n\n\t\t\t}\n\t\t}.bind(this)).then(function(data){\n\t\t\tthis.setState({\n\t\t\t\tdata: data\n\t\t\t}) \n\n\t\t\tvar filteredData = data.filter(d=>d.Trade == this.props.trade && d.Year == this.props.year).sort((a,b)=>{ return b.Value-a.Value }).slice(0,10);\n\n\t\t\tvar margin = { top: 50, left: 0, bottom: 0, right: 0 },\n\t\t\twidth = +d3.select('#worldmap-info-container').style('width').slice(0, -2)*0.3 - margin.left - margin.right,\n        \theight = +d3.select('#worldmap-info-container').style('height').slice(0, -2) - margin.top - margin.bottom;\n        \tconsole.log('draw',height)\n        \tvar unit = height/10.8\n\n\n\t\t\t/*var div = d3.select(\"#sparklines-container\").append(\"div\")\n\t\t\t    .style(\"width\", width + margin.left + margin.right + 'px')\n\t\t\t    .style(\"height\", height + margin.top + margin.bottom + 'px')\n\t\t\t    .attr(\"id\",'sparklines')\n\t\t\t    \n\t\t\t\n\t\t\tdiv.selectAll('rect')\n\t\t\t\t.data(filteredData,function(d){ return d.Country })\n\t\t\t\t.enter()\n\t\t\t\t.append('div')\n\t\t\t\t.attr('id',function(d,i){ return 'div' + i })\n\t\t\t\t.style(\"height\", unit + 'px')\n\t\t\t\t.style(\"height\", width + 'px')\n\t\t\t\t//.text(function(d){ return d.Country })\n\n\t\t\tfilteredData.forEach((target,i)=>{\n\t\t\t\tvar temp = data.filter(d=> d.Country == target.Country && d.Trade == this.props.trade)\n\t\t\t\t//console.log(temp,target.Country)\n\t\t\t\tthis.drawSparkLine(temp,i)\n\t\t\t})*/\n\n\t\t\tvar svg = d3.select(\"#sparklines-container\")\n\t\t\t\t.append(\"svg\")\n\t\t\t    .style(\"width\", width + margin.left + margin.right)\n\t\t\t    .style(\"height\", height + margin.top + margin.bottom)\n\t\t\t    .attr(\"id\",'sparklines')\n\t\t\t    .append('g')\n\t  \t\t\t.attr('id','sparklines-svg')\n\t\t\t\t.attr('transform','translate(' +margin.left+ ','+margin.top+')')\n\n\t\t\tfilteredData.forEach((target,i)=>{\n\t\t\t\tvar temp = data.filter(d=> d.Country == target.Country && d.Trade == this.props.trade)\n\t\t\t\t//console.log(temp,target.Country)\n\t\t\t\tthis.drawSparkLine(temp,i)\n\t\t\t})\n\t\t\t\n\n\t\t\t/*var svg = d3.select(\"#sparklines-container\").append(\"svg\")\n\t\t\t    .style(\"width\", width + margin.left + margin.right + 'px')\n\t\t\t    .style(\"height\", height + margin.top + margin.bottom + 'px')\n\t\t\t    .append('g')\n\t  \t\t\t.attr('id','sparklines')\n\t\t\t\t.attr('transform','translate(' +margin.left+ ',0)')*/\n\n\t\t\t/*var x = d3.scaleOrdinal().domain([2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016]).range([0, 150]);\n\t\t\tconsole.log(d3.extent(filteredData,function(d){ return d[Object.keys(d)[3]]}))\n\t\t\tvar y = d3.scaleLinear().domain(d3.extent(filteredData,function(d){ return d[Object.keys(d)[3]]})).range([0, 30]);*/\n\n\n\t\t\t/*var svg = d3.select(\"#sparklines\").append(\"svg\")\n\t\t\t    .attr(\"width\", width + margin.left + margin.right)\n\t\t\t    .attr(\"height\", height + margin.top + margin.bottom)\n\t\t\t    .append('g')\n\t  \t\t\t.attr('id','ranking-svg')\n\t\t\t\t.attr('transform','translate(' +margin.left+ ',' +margin.top+ ')')*/\n\t\t\t    \n\n\t\t\t\n\n\n\t\t\t\n\t\t}.bind(this))\n\t}\n\n\tdrawSparkLine(data,i){\n\t\t//console.log(data)\n\t\tvar margin = { top: 50, left: 0, bottom: 0, right: 0 },\n\t\t\twidth = +d3.select('#worldmap-info-container').style('width').slice(0, -2)*0.3 - margin.left - margin.right,\n        \theight = +d3.select('#worldmap-info-container').style('height').slice(0, -2) - margin.top - margin.bottom;\n        \n       \tconsole.log('draw spark line',height)\n        d3.select('#sparklines')\n        \t.style(\"width\", width + margin.left + margin.right)\n\t\t\t.style(\"height\", height + margin.top + margin.bottom)\n       \tvar unit = height/10.8\n\n       \tvar xScale = d3.scalePoint().domain([2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016]).range([5, width-5]);\n\t\tvar yScale = d3.scaleLinear().domain(d3.extent(data,function(d){ return d.Value})).range([(i+0.5)*unit-5, (i-0.5)*unit+5]);\n\n       \tvar svg = d3.select('#sparklines-svg')\n\n       \tvar line = d3.line()\n\t\t    .x(function(d) { return xScale(d.Year); }) \n\t\t    .y(function(d) { return yScale(d.Value); })\n\t\t    .curve(d3.curveMonotoneX)\n\n\t\tvar value = data.filter(d=>d.Year == this.props.year)[0].Value\n       \tsvg.append(\"path\")\n\t\t    .datum(data)\n\t\t    .attr(\"id\", \"sparkline-\"+i)\n\t\t    .attr(\"d\", line)\n\t\t    .attr(\"stroke\", \"black\")\n            .attr(\"stroke-width\", 0.5)\n            .attr(\"fill\", \"none\")\n\n        var div = d3.select('.tooltip')\n        svg.append('circle')\n\t\t\t.attr('cx',xScale(this.props.year))\n\t\t\t.attr('cy',yScale(value))\n\t\t\t.attr('id',\"circle-\"+i)\n\t\t\t.attr('r',2)\n\t\t\t.attr('fill','red')\n\t\t\t.on(\"mouseover\", (d) => {\n\t\t\t\t\n\t\t\t\tdiv.style(\"opacity\", .9)\n\t\t\t\t\t.style('z-index',10)\n\t\t\t\tdiv.html(this.props.year)\n\t\t\t\t// data.filter(d=>d.Year == this.props.year)[0].Value\t\n\t\t\t})\n\t\t\t.on(\"mousemove\", function () {\n\t\t\t\tdiv.style(\"left\", (d3.event.pageX + 10) + \"px\")\n\t\t\t\t\t.style(\"top\", (d3.event.pageY - 10) + \"px\")\n\t\t\t})\n\t\t\t.on(\"mouseout\", function () {\n\t\t\t\tdiv.style(\"opacity\", 0)\n\t\t\t\t\t.style('z-index',-10)\n\t\t\t});\n\t\t/*var svg = d3.select('#div'+i)\n\t\t\t.append('svg')\n\t\t\t.attr('width',width)\n\t\t\t.attr('height',unit)\n\t\t\t.attr('id','svg' + i)\n\n\t\tvar value = data.filter(d=>d.Year == this.props.year)[0].Value\n\n\t\tvar xScale = d3.scalePoint().domain([2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016]).range([5, width-5]);\n\t\tvar yScale = d3.scaleLinear().domain(d3.extent(data,function(d){ return d.Value})).range([unit-5, 5]);\n\n\t\t//console.log(d3.extent(data,function(d){ return d.Value}))\n\t\t\n\t\tvar line = d3.line()\n\t\t    .x(function(d) { return xScale(d.Year); }) \n\t\t    .y(function(d) { return yScale(d.Value); })\n\t\t    .curve(d3.curveMonotoneX)\n\n\t\td3.select('#sparklines').style(\"height\", height + 'px').style('width',width + 'px')\n\t\td3.select('#div'+i).style(\"height\", unit + 'px').style('width',width + 'px')\n\t\tsvg.append(\"path\")\n\t\t    .datum(data)\n\t\t    .attr(\"id\", \"sparkline-\"+i)\n\t\t    .attr(\"d\", line)\n\t\t    .attr(\"stroke\", \"black\")\n            .attr(\"stroke-width\", 0.5)\n            .attr(\"fill\", \"none\")\n   \n        var div = d3.select('.tooltip')\n        svg.append('circle')\n\t\t\t.attr('cx',xScale(this.props.year))\n\t\t\t.attr('cy',yScale(value))\n\t\t\t.attr('r',2)\n\t\t\t.attr('fill','red')\n\t\t\t.on(\"mouseover\", (d) => {\n\t\t\t\t\n\t\t\t\tdiv.style(\"opacity\", .9)\n\t\t\t\t\t.style('z-index',10)\n\t\t\t\tdiv.html(this.props.year)\n\t\t\t\t// data.filter(d=>d.Year == this.props.year)[0].Value\t\n\t\t\t})\n\t\t\t.on(\"mousemove\", function () {\n\t\t\t\tdiv.style(\"left\", (d3.event.pageX + 10) + \"px\")\n\t\t\t\t\t.style(\"top\", (d3.event.pageY - 10) + \"px\")\n\t\t\t})\n\t\t\t.on(\"mouseout\", function () {\n\t\t\t\tdiv.style(\"opacity\", 0)\n\t\t\t\t\t.style('z-index',-10)\n\t\t\t});*/\n\t\n\t}\n\n\tupDate(data,i){\n\n\t\tvar margin = { top: 50, left: 0, bottom: 0, right: 0 },\n\t\t\twidth = +d3.select('#worldmap-info-container').style('width').slice(0, -2)*0.3 - margin.left - margin.right,\n        \theight = +d3.select('#worldmap-info-container').style('height').slice(0, -2) - margin.top - margin.bottom;\n       \tconsole.log(width,height)\n       \tvar unit = height/10.8\n\t\t//console.log(data,i)\n\t\tvar value = data.filter(d=>d.Year == this.props.year)[0].Value\n\t\tvar xScale = d3.scalePoint().domain([2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016]).range([5, width-5]);\n\t\tvar yScale = d3.scaleLinear().domain(d3.extent(data,function(d){ return d.Value})).range([(i+0.5)*unit-5, (i-0.5)*unit+5]);\n\n\t\t//console.log(d3.extent(data,function(d){ return d.Value}))\n\t\td3.select('#sparklines')\n\t\t\t.style(\"width\", width + margin.left + margin.right)\n\t\t\t.style(\"height\", height + margin.top + margin.bottom)\n\n\t\tvar line = d3.line()\n\t\t    .x(function(d) { return xScale(d.Year); }) \n\t\t    .y(function(d) { return yScale(d.Value); })\n\t\t    .curve(d3.curveMonotoneX)\n\n\t\t/*var svg = d3.select('#svg'+i)\n\t\t\t\t\t.attr('width',width)\n\t\t\t\t\t.attr('height',unit)\n\n\t\td3.select('#sparklines').style(\"height\", height + 'px').style('width',width + 'px')\n\t\td3.select('#div'+i).style(\"height\", unit + 'px').style('width',width + 'px')*/\n\n\t\td3.select('#sparkline-'+i)\n\t\t\t.datum(data)\n\t\t    //.attr(\"id\", \"sparkline-\"+i)\n\t\t    .transition() \n\t\t    .duration(500)\n\t\t    .attr(\"d\", line)\n\t\t    .attr(\"stroke\", \"black\")\n            .attr(\"stroke-width\", 0.5)\n            .attr(\"fill\", \"none\")\n\n        d3.select('#circle-'+i)\n        \t.transition()\n\t\t    .duration(500)\n\t\t\t.attr('cx',xScale(this.props.year))\n\t\t\t.attr('cy',yScale(value))\n\t\t\t.attr('r',2)\n\t\t\t.attr('fill','red')\n\t\t\n    }\n\n\trender(){\n\t\treturn(\n\t\t\t<div id='sparklines-container'>\n\n\t\t\t</div>\n\t\t)\n\t}\n\n}"]},"metadata":{},"sourceType":"module"}